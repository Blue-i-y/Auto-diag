import os
import requests
import sys

def check_directories(domain, wordlist):
    try:
        with open(wordlist, 'r') as f:
            directories = f.read().splitlines()
    except FileNotFoundError:
        print("Wordlist not found.")
        sys.exit(1)

    # Check if the domain is in the correct format
    if not domain.startswith("http://") and not domain.startswith("https://"):
        print("Invalid domain format. Please enter the domain in the format: http://host/ or https://host/")
        sys.exit(1)

    total_subdomains = len(directories)
    tested_subdomains = 0


    for directory in directories:

        dir_url = f"{domain}/{directory}"
        tested_subdomains += 1
        completion_percentage = (tested_subdomains / total_subdomains) * 100
        os.system('cls' if os.name == 'nt' else 'clear')
        print(f"Test en cours : {completion_percentage:.2f}%")
        print(f"Sous-domaines test√©s : {dir_url}\n{tested_subdomains}/{total_subdomains}")

        try:
            response = requests.get(dir_url)
            if response.status_code == 200:
                print("Valid directory:", dir_url)
            elif response.status_code == 404:
                pass
            else:
                print("Error accessing directory:", dir_url)
        except requests.ConnectionError:
            print("Connection error while accessing directory:", dir_url)

def main():
    if len(sys.argv) != 2 and len(sys.argv) != 3:
        print("Usage: python DirEnum.py <domain> [<wordlist_file>]")
        sys.exit(1)

    domain = sys.argv[1]

    if len(sys.argv) == 3:
        wordlist = sys.argv[2]
    elif len(sys.argv) == 2:
        wordlist = "/usr/share/wordlists/dirb/common.txt"


    check_directories(domain, wordlist)

if __name__ == "__main__":
    main()
